{% extends "base.html" %}
{% block title %}Browse Articles{% endblock %}
{% block content %}
    <div class="browse-container">
        <h1>Browse Articles</h1>
        <p>Explore articles written by students across Indonesia.</p>
        <div class="article-list">
            {% if articles %}
                {% for article in articles %}
                    <div class="article-item">
                        <h3>{{ article.subtopic }} <span class="expand-btn">[Expand]</span></h3>
                        <div class="article-content" style="display: none;">
                            <p>{{ article.content }}</p>
                            {% if article.image_filename %}
                                <img src="{{ url_for('static', filename='images/' + article.image_filename) }}" alt="Article Image" style="max-width: 200px;">
                            {% endif %}
                            <p><small>Posted on {{ article.created_at }}</small></p>
                            {% if user_role != 'teacher' and user_role != 'superuser' %}
                                <form method="POST" action="{{ url_for('like_article', article_id=article.id) }}">
                                    <button type="submit" {% if article.liked_by_user %}disabled{% endif %}>
                                        {% if article.liked_by_user %}
                                            Liked
                                        {% else %}
                                            Like
                                        {% endif %}
                                    </button>
                                </form>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>No articles available.</p>
            {% endif %}
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const expandButtons = document.querySelectorAll('.expand-btn');
            expandButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const content = this.parentElement.nextElementSibling;
                    if (content.style.display === 'none' || content.style.display === '') {
                        content.style.display = 'block';
                        this.textContent = '[Collapse]';
                    } else {
                        content.style.display = 'none';
                        this.textContent = '[Expand]';
                    }
                });
            });
        });
    </script>
{% endblock %}